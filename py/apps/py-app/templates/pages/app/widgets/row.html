<tr id="widget-{{ widget.id }}"
    sse-swap="widget-updated-{{ widget.id }}"
    hx-swap="outerHTML">
    <td>
        <a href="/app/widgets/{{ widget.id }}"
           hx-get="/app/widgets/{{ widget.id }}"
           hx-target="#main-content"
           hx-push-url="true"
           class="font-medium hover:text-primary">
            {{ widget.name }}
        </a>
        {% if widget.description %}
        <p class="text-xs text-muted-foreground truncate max-w-xs">{{ widget.description }}</p>
        {% endif %}
    </td>
    <td>
        {% if processing %}
        <span class="uk-badge uk-badge-secondary flex items-center gap-1">
            <span class="animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full"></span>
            Processing...
        </span>
        {% elif widget.status == 'active' %}
        <span class="uk-badge uk-badge-success">Active</span>
        {% elif widget.status == 'draft' %}
        <span class="uk-badge uk-badge-secondary">Draft</span>
        {% elif widget.status == 'archived' %}
        <span class="uk-badge uk-badge-muted">Archived</span>
        {% else %}
        <span class="uk-badge">{{ widget.status }}</span>
        {% endif %}
    </td>
    <td>
        <span class="text-sm">{{ widget.priority }}</span>
    </td>
    <td>
        {% if widget.is_public %}
        <uk-icon icon="globe" class="w-4 h-4 text-green-500" title="Public"></uk-icon>
        {% else %}
        <uk-icon icon="lock" class="w-4 h-4 text-muted-foreground" title="Private"></uk-icon>
        {% endif %}
    </td>
    <td class="text-sm text-muted-foreground">
        {{ widget.created_at.strftime('%b %d, %Y') }}
    </td>
    <td>
        <div class="flex gap-1">
            {% if not processing %}
                {% if widget.status == 'draft' %}
                <button hx-post="/app/widgets/{{ widget.id }}/activate"
                        hx-target="#widget-{{ widget.id }}"
                        hx-swap="outerHTML"
                        class="uk-button uk-button-default uk-button-small"
                        title="Activate">
                    <uk-icon icon="play" class="w-4 h-4"></uk-icon>
                </button>
                <button hx-post="/app/widgets/{{ widget.id }}/process"
                        hx-target="#widget-{{ widget.id }}"
                        hx-swap="outerHTML"
                        class="uk-button uk-button-primary uk-button-small"
                        title="Process (background job)">
                    <uk-icon icon="zap" class="w-4 h-4"></uk-icon>
                </button>
                {% elif widget.status == 'active' %}
                <button hx-post="/app/widgets/{{ widget.id }}/archive"
                        hx-target="#widget-{{ widget.id }}"
                        hx-swap="outerHTML"
                        class="uk-button uk-button-default uk-button-small"
                        title="Archive">
                    <uk-icon icon="archive" class="w-4 h-4"></uk-icon>
                </button>
                {% endif %}

                <a href="/app/widgets/{{ widget.id }}/edit"
                   hx-get="/app/widgets/{{ widget.id }}/edit"
                   hx-target="#main-content"
                   hx-push-url="true"
                   class="uk-button uk-button-default uk-button-small"
                   title="Edit">
                    <uk-icon icon="pencil" class="w-4 h-4"></uk-icon>
                </a>

                <button hx-delete="/app/widgets/{{ widget.id }}"
                        hx-target="#widget-{{ widget.id }}"
                        hx-swap="outerHTML swap:1s"
                        hx-confirm="Are you sure you want to delete this widget?"
                        class="uk-button uk-button-danger uk-button-small"
                        title="Delete">
                    <uk-icon icon="trash-2" class="w-4 h-4"></uk-icon>
                </button>
            {% else %}
                <span class="text-xs text-muted-foreground">Please wait...</span>
            {% endif %}
        </div>
    </td>
</tr>
